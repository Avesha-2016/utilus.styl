// Basic color blending
utilus_blend($top,$bottom = #FFF)
  // Only normal blending here for now
  return $top if alpha($top) == 1
  return $bottom if alpha($top) == 0

  newR = (1 - alpha($top)) *   red($bottom) + alpha($top) *   red($top)
  newG = (1 - alpha($top)) * green($bottom) + alpha($top) * green($top)
  newB = (1 - alpha($top)) *  blue($bottom) + alpha($top) *  blue($top)
  newA = 1 // FIXME: should be smth different if the alpha of $bottom != 1

  return rgba(newR,newG,newB,newA)

blend ?= utilus_blend
